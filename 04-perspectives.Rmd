```{r, echo = FALSE, warning = FALSE, message = FALSE}
# Preparation

# Read in all years of data
library(data.table)
library(survey)
library(ggplot2)
library(scales)
library(knitr)
library(kableExtra)
source(paste0(getwd(), "/_RCode/read_census_data.R"))
source(paste0(getwd(), "/_RCode/make_table_data.R"))
source(paste0(getwd(), "/_RCode/make_plot_data.R"))
source(paste0(getwd(), "/_RCode/additional_functions.R"))
```

# Perspectives on Burning Man

## Burner Identity and the 10 Principles 

### Do you identify as a Burner?

```{r}
burnerID <- makePlotData("Do you identify as a Burner?",
                         varNameTable = varNameTable,
                         designs = list(design16, design17, design18, design19,
                                        design22),
                         years = c(2016:2019, 2022),
                         levels = c(rep(list(c("No", "Sort_of", "Yes")), times = 4), 
                                    list(c("No", "Sort of", "Yes"))),
                         labels = c("No", "Sort of", "Yes"))

ggplot(burnerID, aes(x = year, y = est, fill = labels)) +
  geom_area(alpha = 0.65) +
  scale_y_continuous(labels = percent) +
  scale_x_continuous(breaks = c(2016:2019, 2022), labels = c(2016:2019, 2022)) +
  scale_fill_manual(values = c("#EA008B", "#FF416f", "#FF7457")[3:1]) +
  labs(x = "", y = "", fill = "Do you identify as a Burner?") +
  theme_bw()

makeTableData(attendRegional) |>
  kbl(col.names = c(2016:2019, 2022),
      row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  kable_styling() |>
  column_spec(column = 1:6, width_min = "9.5em") |>
  scroll_box(width = "100%")
```


### Which of the 10 Principles do you practice most frequently in your everyday life?
```{r, echo = FALSE}
prinFreq <- makePlotData(varName = "Which of the 10 Principles do you find most difficult to practice in your everyday life?",
                        varNameTable = varNameTable,
                        designs = list(design16, design17, design18, 
                                       design19, design22),
                        years = c(2016:2019, 2022), 
                        levels = list("yes", "yes", "yes", "yes", TRUE),
                        labels = c("Radical Inclusion", "Gifting",
                                   "Decommodification", "Radical Self-reliance",
                                   "Radical Self-expression", "Communal Effort", 
                                   "Civic Resposibility","Leave No Trace", 
                                   "Participation", "Immediacy"),
                        labelOrder = c(4,9,7,6,1,8,2,5,10,3))

ggplot(prinFreq[prinDif$year == 2022,], aes(x = labels, y = est)) +
  geom_bar(stat = "identity", fill = "#EA008B") +
  scale_y_continuous(labels = percent) +
  labs(x = "Ten Principles", y = "") +
  theme_bw() +
  coord_flip()

makeTableData(prinFreq)[10:1,] |>
  kbl(col.names = c(2016:2019, 2022), row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  column_spec(column = 1:6, width_min = "9.5em") |>
  kable_styling() |>
  scroll_box(width = "100%")
```


### Which of the 10 Principles are the most difficult to practice in every day life?
```{r, echo = FALSE}
prinDif <- makePlotData(varName = "Which of the 10 Principles do you find most difficult to practice in your everyday life?",
                        varNameTable = varNameTable,
                        designs = list(design16, design17, design18, 
                                       design19, design22),
                        years = c(2016:2019, 2022), 
                        levels = list("yes", "yes", "yes", "yes", TRUE),
                        labels = c("Radical Inclusion", "Gifting",
                                   "Decommodification", "Radical Self-reliance",
                                   "Radical Self-expression", "Communal Effort", 
                                   "Civic Resposibility","Leave No Trace", 
                                   "Participation", "Immediacy"),
                        labelOrder = rev(c(3, 10, 5, 2, 8, 1, 6, 7, 9, 4)))

ggplot(prinDif[prinDif$year == 2022,], aes(x = labels, y = est)) +
  geom_bar(stat = "identity", fill = "#EA008B") +
  scale_y_continuous(labels = percent) +
  labs(x = "Ten Principles", y = "") +
  theme_bw() +
  coord_flip()

makeTableData(prinDif)[10:1,] |>
  kbl(col.names = c(2016:2019, 2022), row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  column_spec(column = 1:6, width_min = "9.5em") |>
  kable_styling() |>
  scroll_box(width = "100%")
```

### Importance of the 10 Principles
```{r}
importance10p <- makePlotData("How important are the 10 Principles to you?",
                             varNameTable = varNameTable,
                             designs = list(design15, design16, design17, design18, design19, design22),
                             years = c(2015:2019, 2022),
                             levels = c(rep(list(c("Important", 
                                                   "Moderately_imp",
                                                   "Not_imp",
                                                   "Slightly_imp",
                                                   "Very_imp")), times = 5), 
                                        list(c("Important", 
                                               "Moderately important",
                                               "Not important",
                                               "Slightly important",
                                               "Very important"))),
                             labels = c("Important", 
                                        "Moderately important",
                                        "Not important",
                                        "Slightly important",
                                        "Very important"),
                             labelOrder = c(3, 4, 2, 1, 5))

ggplot(importance10p, aes(x = year, y = est, fill = labels)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_y_continuous(labels = percent) +
  scale_x_continuous(breaks = c(2016:2019, 2022)) +
  labs(x = "", y = "", fill = "Importance") +
  theme_bw() +
  scale_fill_manual(values = c("#EA008B", "#FF416f", "#FF7457", "#FFA349", "#FFCF50"))

makeTableData(importance10p) |>
  kbl(col.names = c(2015:2019, 2022),
      row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  kable_styling() |>
  column_spec(column = 1:7, width_min = "9.5em") |>
  scroll_box(width = "100%")
```


### Ten principles essential to creating an authentic Burning Man experience
```{r}
essential10p <- makePlotData("How essential are the 10 Principles to creating an authentic Burning Man experience?",
                             varNameTable = varNameTable,
                             designs = list(design15, design16, design17, design18, design19, design22),
                             years = c(2015:2019, 2022),
                             levels = c(rep(list(c("Important", 
                                                   "Moderately_imp",
                                                   "Not_imp",
                                                   "Slightly_imp",
                                                   "Very_imp")), times = 5), 
                                        list(c("Important", 
                                               "Moderately important",
                                               "Not important",
                                               "Slightly important",
                                               "Very important"))),
                             labels = c("Essential", 
                                        "Moderately essential",
                                        "Not essential",
                                        "Slightly essential",
                                        "Very essential"),
                             labelOrder = c(3, 4, 2, 1, 5))

ggplot(essential10p, aes(x = year, y = est, fill = labels)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_y_continuous(labels = percent) +
  scale_x_continuous(breaks = c(2016:2019, 2022)) +
  labs(x = "", y = "", fill = "Essentiality") +
  theme_bw() +
  scale_fill_manual(values = c("#EA008B", "#FF416f", "#FF7457", "#FFA349", "#FFCF50"))

makeTableData(essential10p) |>
  kbl(col.names = c(2015:2019, 2022),
      row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  kable_styling() |>
  column_spec(column = 1:7, width_min = "9.5em") |>
  scroll_box(width = "100%")
```


### Incorporating the 10 principles in the workplace
```{r}
workplace10p.1 <- makePlotData("Are you incorporating any of the 10 Principles in your workplace?",
                             varNameTable = varNameTable,
                             designs = list(design16, design17, design18, 
                                            design19),
                             years = c(2016:2019),
                             levels = rep(list(c("I_have_modeled_my_activities_on_them",
                                               "I_try_to_practice_them",
                                               "No")), times = 4),
                             labels = c("I have modeled my \n professional activities \n on them",
                                        "I try to practice them \n at my worplace",
                                        "No, I am not"),
                             labelOrder = c(1, 2, 3))

workplace10p.2 <- makePlotData("Are you incorporating any of the 10 Principles in your workplace?",
                               varNameTable = varNameTable,
                               designs = list(design22),
                               years = c(2022),
                               levels = c("Modeled professional activity",
                                                 "No, I am not",
                                                 "Not applicable",
                                                 "Practice at my workplace"),
                               labels = c("I have modeled my \n professional activities \n on them",
                                          "No, I am not",
                                          "Not applicable",
                                          "I try to practice them \n at my workplace"),
                               labelOrder = c(1, 4, 2, 3))

ggplot(workplace10p.2, aes(x = labels, y = est)) +
  geom_bar(stat = "identity", fill = "#EA008B") +
  scale_y_continuous(labels = percent) +
  labs(x = "Incorporation of 10 Principles in your workplace", y = "") +
  theme_bw()

workplace10p.1$labels <- factor(workplace10p.1$labels, 
                                levels = c("I have modeled my \n professional activities \n on them",
                                           "I try to practice them \n at my workplace",
                                           "No, I am not",
                                           "Not applicable"))
workplace10p <- rbind(workplace10p.1, workplace10p.2)
makeTableData(essential10p) |>
  kbl(col.names = c(2016:2019, 2022),
      row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  kable_styling() |>
  column_spec(column = 1:6, width_min = "9.5em") |>
  scroll_box(width = "100%")
```


## Children at Burning Man

### Have you ever brought children under 18 to Black Rock City?
```{r}
broughtChildren <- makePlotData("Have you ever brought children under 18 to Black Rock City?",
                                designs = list(designs14, designs15, designs16,
                                               designs17, designs18, designs19,
                                               designs22),
                                years = c(2014:2019, 2022),
                                levels = c(rep(list(c("No_but_I_would",
                                                      "No_I_would_not",
                                                      "Yes_and_I_would_again",
                                                      "Yes_but_I_would_not")), times = 6),
                                           list(c("No, but I would",
                                                  "No, and I would not",
                                                  "Yes, and I would again",
                                                  "Yes, but I would not again"))),
                                labels = c("No, but I would",
                                                  "No, and I would not",
                                                  "Yes, and I would again",
                                                  "Yes, but I would not again"),
                                labelOrder = c(1,2,3,4))

ggplot(broughtChildren, aes(x = year, y = est, color = labels)) +
  geom_line(linewidth = 1.5) +
  geom_point(size = 2.25, color = "black") +
  theme_bw(13) +
  theme(panel.grid.minor = element_blank()) +
  scale_x_continuous(breaks = c(2014:2019, 2022), labels = c(2014:2019, 2022)) +
  scale_y_continuous(labels = percent) +
  scale_color_manual(values = c("#EA008B", "#FF416f", "#FF7457", "#FFA349")) +
  labs(x = "Year", y = "", color = "Brought children?")

makeTableData(broughtChildren) |>
  kbl(col.names = c(2014:2019, 2022), row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  column_spec(column = 1:8, width_min = "9.5em") |>
  kable_styling() |>
  scroll_box(width = "100%")
```

### Do you think that Burning Man event attendance should be restricted to participants aged 18 or older?
```{r}
restrictAge.1 <- makePlotData("Do you think that Burning Man event attendance should be restricted to participants aged 18 or older?",
                              varNameTable = varNameTable,
                              designs = list(design15),
                              year = 2015,
                              levels = c("No", "No_opinion",
                                         "Yes_only18plus", "Yes_only21plus"),
                              labels = c("No, all ages", "No opinion",
                                         "Yes, only 18+"),
                              groups = c(1, 2, 3, 3),
                              labelOrder = c(1, 3, 2))

restrictAge.2 <- makePlotData("Do you think that Burning Man event attendance should be restricted to participants aged 18 or older?",
                              varNameTable = varNameTable,
                              designs = list(design16, design17, design18,
                                             design19, design22),
                              year = c(2015:2019, 2022),
                              levels = c("No", "No_opinion",
                                         "Yes_only18plus", "Yes_only21plus"),
                              labels = c("No, all ages", "No opinion",
                                         "Yes, only 18+"),
                              groups = c(1, 2, 3, 3),
                              labelOrder = c(1, 3, 2))

restrictAge <- rbind(restrictAge.1, restrictAge.2)

ggplot(broughtChildren, aes(x = year, y = est, color = labels)) +
  geom_line(linewidth = 1.5) +
  geom_point(size = 2.25, color = "black") +
  theme_bw(13) +
  theme(panel.grid.minor = element_blank()) +
  scale_x_continuous(breaks = c(2015:2019, 2022), labels = c(2015:2019, 2022)) +
  scale_y_continuous(labels = percent) +
  scale_color_manual(values = c("#EA008B", "#FF416f", "#FF7457", "#FFA349")) +
  labs(x = "Year", y = "", color = "Age restriction")

makeTableData(broughtChildren) |>
  kbl(col.names = c(2015:2019, 2022), row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  column_spec(column = 1:7, width_min = "9.5em") |>
  kable_styling() |>
  scroll_box(width = "100%")
```

## Burning Man Project's Nonprofit Activites

### Familiarity with programs and affiliates of the nonprofit Burning Man Project
```{r}
familiarity <- makePlotData("Are you familiar with the following programs and affiliates of the nonprofit Burning Man Project?",
                            varNameTable = varNameTable,
                            designs = list(design15, design16, design17,
                                           design18, design19, design22),
                            years = c(2015:2019, 2022),
                            levels = c(as.list(rep("yes", times = 5)), 
                                           list(TRUE)),
                            labels = c("Burners Without Borders",
                                       "Burning Man Arts",
                                       "Black Rock Labs (formerly \n Black Rock Solar)",
                                       "Burning Man Regional Network",
                                       "Fly Ranch Project",
                                       "Philosophical Center"))
```


### Should the Burning Man Project be involved in faciliating and producing year-round activites?



### How would you distribute $1,000 to donate to programs of the nonprofit Burning man Project?



## Sustainability

### What new sustainability projects did you notice while in BRC this year?



### How did you (and your camp or project) begin to address sustainability in Black Rock City?



### How important to you is it that the Burning Man Project visibly engages in best practices in environmental sustainability?  



## Radical Inclusion, Diversity, and Equity (R.I.D.E.)

### How did you see R.I.D.E. in action while in BRC 



### How did you personally work to create a more diverse and welcoming Black Rock City?



