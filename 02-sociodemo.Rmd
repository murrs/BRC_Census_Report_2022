```{r, echo = FALSE, warning = FALSE, message = FALSE}
# Preparation

# Read in all years of data
library(data.table)
library(survey)
library(ggplot2)
library(scales)
library(knitr)
library(kableExtra)
source(paste0(getwd(), "/_RCode/read_census_data.R"))
source(paste0(getwd(), "/_RCode/make_table_data.R"))
source(paste0(getwd(), "/_RCode/make_plot_data.R"))
source(paste0(getwd(), "/_RCode/additional_functions.R"))
```


# Demographics and social characteristics {#sociodemo}

## Burning Man Attendence

### Propotion of Virgins
```{r, echo = FALSE}
virgin <- makePlotData(varName = "Virgin", varNameTable,
                          designs = list(design13, design14, design15, 
                                         design16, design17, design18, 
                                         design19, design22),
                          years = c(2013:2019, 2022), 
                          levels = list(c("no", "yes"), c("no", "yes"),
                                        c("no", "yes"), c("no", "yes"),
                                        c("no", "yes"), c("no", "yes"),
                                        c("no", "yes"), c(FALSE, TRUE)),
                          labels = c("Not Virgin", "Virgin"),
                          labelOrder = c("Virgin", "Not Virgin"))


ggplot(virgin[virgin$labels == "Virgin",], aes(x = year, y = est)) +
  geom_line(linewidth = 1.5, color = "#EA008B") +
  geom_point(size = 2.25, color = "black") +
  geom_errorbar(aes(ymin = lower, ymax = upper), color = "black", width = 0.2,
                linewidth = 1.25) +
  theme_bw(13) +
  theme(panel.grid.minor = element_blank()) +
  # scale_color_brewer(type = "seq", palette = 11) +
  scale_x_continuous(breaks = c(2013:2019, 2022), labels = c(2013:2019, 2022)) +
  scale_y_continuous(labels = percent) +
  labs(x = "Year", y = "Percent of Burners at BRC in 2022")

#An annoying thing happens when subsetting to one row.  The table class turns
#  into a character vector.  Happy to take suggestions on a better way to do
#  this.
virginTable <- make_table_data(virgin, confInt = "plusminus")
virginTable <- virginTable[2,] |>
  matrix(nrow = 1) |>
  as.table()
rownames(virginTable) = "Virgin"
colnames(virginTable) = c(2013:2019, 2022)
virginTable |>
  kbl() |>
  kable_paper("striped", full_width = F) |>
  kable_styling(font_size = 4)
```



### Number of burns attended




<!-- Other ideas?  Average number of burns attended without a break? -->



## Demographics

### Age


### Current gender




### Sex assigned at birth


### Gender identity



<!--  Do you consider yourself to be any of the following (transperson etc.) -->


### Preferred pronouns


### Personal income in 2021


### Household income in 2021


### Highest level of education completed


## Residence

### Residence inside of Black Rock City


### Residence outside of Black Rock City


### California and Nevada County Residence

<!-- ZIP Code converted to county and maybe smoothed -->

### State residence

<!-- ZIP code converted to state -->

### Canadian province residence

<!-- Postal code converted to province -->

## Voting and politics

### Number of times voted in last four Federal US elections 

<!-- Combine with voting eligiblity -->

### Political party affiliation



### Political views



## Ethinicity and language

### Ethnoracial background



### Person of Color



### First language learned


## Spirituality

### Spirituality



### Religion or religious denomination

<!-- Something needs to be done to address the multiple religions selection, not sure what -->

## Disabilities

### Identify with a disability status

<!-- Maybe separate into binary yes/no and categories if yes? -->


## Sexuality

### Sexual orientation



### Sexuality labels



## Relationships

### Romantic Orientation



### Partner in the default world



### Relationship labels